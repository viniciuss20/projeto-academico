<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gerenciar Conta</title>

    <link rel="stylesheet" href="manage-account.css" />

    <style>
        /* LOGO NO CANTO SUPERIOR DIREITO */
        .geo-logo-top {
            position: absolute;
            top: 20px;
            right: 30px;
            height: 90px;
            width: auto;
        }
    </style>
</head>

<body>
    <div class="layout">

        <!-- SIDEBAR COM ATIVIDADES ADICIONADO -->
        <aside class="sidebar">
            <div class="profile">

                <!-- âœ” Avatar CORRIGIDO -->
                <img src="img/image.png" alt="avatar" class="avatar-img">

                <h3 id="userNameSidebar">UsuÃ¡rio</h3>
            </div>

            <ul class="menu">
                <li onclick="window.location.href='dashboard.html'">
                    <span>ğŸ“Š</span> Dashboard
                </li>

                <li class="active">
                    <span>ğŸ‘¤</span> Detalhes da Conta
                </li>

                <li onclick="window.location.href='atividades.html'">
                    <span>ğŸ“‹</span> Atividades
                </li>

                <li onclick="window.location.href='change-password.html'">
                    <span>ğŸ”</span> Alterar Senha
                </li>

                <li onclick="logout()">
                    <span>ğŸšª</span> Sair
                </li>
            </ul>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="content">

            <!-- âœ… LOGO CORRIGIDA NO CANTO SUPERIOR DIREITO -->
            <img src="img/geo-logo.png" alt="GeoBrasil Logo" class="geo-logo-top">

            <h1>ConfiguraÃ§Ãµes da Conta</h1>

            <form class="form">
                <label>EndereÃ§o de Email</label>
                <input type="email" id="email" placeholder="email@exemplo.com" />

                <label>Nome</label>
                <input type="text" id="firstName" placeholder="Seu nome" />

                <label>Sobrenome</label>
                <input type="text" id="lastName" placeholder="Seu sobrenome" />

                <button type="button" class="btn-primary" id="saveBtn">Salvar</button>
            </form>
        </main>

    </div>

<script>
    // FunÃ§Ã£o para carregar dados do usuÃ¡rio
    function loadUserData() {
        try {
            // Recupera os dados do usuÃ¡rio do localStorage
            const userDataString = localStorage.getItem('user');
            
            if (userDataString) {
                const userData = JSON.parse(userDataString);
                
                // Preenche os campos do formulÃ¡rio
                if (userData.email) {
                    document.getElementById("email").value = userData.email;
                }
                
                if (userData.username) {
                    document.getElementById("firstName").value = userData.username;
                    document.getElementById("userNameSidebar").innerText = userData.username;
                }
                
                if (userData.sobrenome) {
                    document.getElementById("lastName").value = userData.sobrenome;
                }
            } else {
                // Fallback caso nÃ£o encontre dados
                const usuario = localStorage.getItem("usuario") || "UsuÃ¡rio";
                document.getElementById("userNameSidebar").innerText = usuario;
            }
        } catch (error) {
            console.error("Erro ao carregar dados do usuÃ¡rio:", error);
        }
    }

    // FunÃ§Ã£o para salvar dados do usuÃ¡rio
    function saveUserData() {
        try {
            const email = document.getElementById("email").value;
            const firstName = document.getElementById("firstName").value;
            const lastName = document.getElementById("lastName").value;

            // Cria objeto com os dados atualizados
            const userData = {
                email: email,
                username: firstName,
                sobrenome: lastName
            };

            // Salva no localStorage
            localStorage.setItem('user', JSON.stringify(userData));
            localStorage.setItem('usuario', firstName); // MantÃ©m compatibilidade

            // Atualiza o nome na sidebar
            document.getElementById("userNameSidebar").innerText = firstName;

            alert("Dados salvos com sucesso!");
        } catch (error) {
            console.error("Erro ao salvar dados:", error);
            alert("Erro ao salvar os dados. Tente novamente.");
        }
    }

    // FunÃ§Ã£o de logout
    function logout() {
        localStorage.removeItem("usuario");
        localStorage.removeItem("user");
        window.location.href = "login.html";
    }

    // Carrega os dados quando a pÃ¡gina carregar
    document.addEventListener("DOMContentLoaded", () => {
        loadUserData();

        // Adiciona evento de clique no botÃ£o Salvar
        document.getElementById("saveBtn").addEventListener("click", saveUserData);
    });
</script>

</body>
</html>